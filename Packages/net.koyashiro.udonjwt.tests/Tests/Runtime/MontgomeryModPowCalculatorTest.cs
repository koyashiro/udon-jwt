using UnityEngine;
using UdonSharp;
using Koyashiro.UdonJwt.Numerics;

namespace Koyashiro.UdonJwt.Tests
{
    public class MontgomeryModPowCalculatorTest : UdonSharpBehaviour
    {
        [SerializeField]
        private MontgomeryModPowCalculator _calculator;

        [SerializeField]
        private MontgomeryModPowCalculatorCallback _callback;

        public void Start()
        {
            // 32317006071311007300714876688669951960444102669715484032130345427524655138867890893197201411522913463688717960921898019494119559150490921095088152386448283120630877367300996091750197750389652106796057638384067568276792218642619756161838094338476170470581645852036305042887575891541065808607552399123930385521914333389668342420684974786564569494856176035326322058077805659331026192708460314150258592864177116725943603718461857357598351152301645904403697613233287231227125684710820209725157101726931323469678542580656697935045997268352998638215525166389437335543602135433229604645318478604952148193555853611059596230656
            _calculator.R = new uint[] { 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001 };

            // 10752495291469592988871482137472547201628786740555788129558685801976946241471273608292489779867942618539676802954364649599884240419306774319044150678476527904885963884020353832761740193920718316224230738342275820623227271562320208999743041658708492804605786150247406967800172631573150794349688137707747852968049686257612225295825627274502499702912420409668282813556442390195992458184278182643721618642134473467361807484075534940738157800207351955358123223289188138561750784973570186610762751361706681057554236144250559470685192414530790464913848365939836220591476158711123162880542445929274225967499199767010341199950
            _calculator.R2 = new uint[] { 0xe086a04e, 0x18a37f03, 0x9d6ddb73, 0x24ee0efe, 0xb756d0ae, 0xcf5c9205, 0x5e116a41, 0x7e3d5bd8, 0xabcea141, 0xc3df1e3a, 0x9c589752, 0xd91f7ff6, 0xbcca1448, 0x563c4e54, 0x5b03ddbb, 0xc4b40f30, 0x34af7eca, 0xfc496247, 0x86d4393c, 0x92b7a6b3, 0x913f557a, 0x20e0e08b, 0x196f7aca, 0x21007507, 0xeaba29b9, 0xf4c54a86, 0x83dec291, 0xc012cd00, 0xed8903ab, 0x4e62d201, 0xbf48d080, 0x51d5f5f8, 0x52c15122, 0xbde18472, 0xf53c22c6, 0x8ef6d571, 0xf90b13de, 0x637785b2, 0x8b66ea37, 0x9a5c79f3, 0x62ae3ad6, 0xcee77a03, 0xe17ccef0, 0xf90a7b76, 0x0a6704ab, 0x33dbaefc, 0x8a9b6b0e, 0x626a879a, 0xa71a2dd8, 0x52488361, 0x3505cc25, 0x24df5f7d, 0x32fa1bca, 0x4b4ccd9d, 0x185eec2f, 0x790b7f9f, 0xd8e36171, 0x4790905a, 0xbb68b409, 0x75a9e765, 0x0e8a18cb, 0xa6695eb7, 0xc787436b, 0x552d1975 };

            // 23817112026095398348168316784074648735166923844001761352648336796786076064019781900685045881930454109254458176069694614728426020569290216880435845951972041934207615800651254972095720464842627108774229044075989075043458844881376197150895162098760426279313629366148094481798968962428031346475332545829706318947787126136654199567027153620122901419579084772113842601682613289115969715808886790410186566362950036215125887056076925295612270056215532161726652535729229504812576828366593828615836177521007602599505727705151738043587003986617290187624467116225503330972034498848230607107413364942025915341721029684276811490841
            _calculator.N = new uint[] { 0xdd876619, 0xfcde8005, 0xa9f8105e, 0xd9cb60a5, 0x0a812a3d, 0x5a1f10fc, 0xdb3f99bd, 0xb0659477, 0x0c59abd4, 0x1369a293, 0x905296ff, 0x3a480932, 0xad95dca7, 0xdf46b759, 0x8780d054, 0xf0fb7151, 0x2504e92a, 0xb3c98650, 0x1b6638cb, 0xe75dd8a8, 0x0d4253c9, 0xb7c947d7, 0x49ea3c32, 0xece6f144, 0xe199c535, 0x21eef0f6, 0xc79ddd13, 0xee70c80e, 0x5976e7d3, 0xe05989bb, 0x2c78cd93, 0x0dcc723e, 0x8cdfc412, 0x1149e9b0, 0xa7bd4698, 0x9bad0d5f, 0xff4b3140, 0x1d0fffb3, 0x9d7212f2, 0x6b53197a, 0xd3bb153a, 0x9b55470f, 0x41b5b60f, 0xa261a6c8, 0x242e3481, 0x7d07c2f8, 0x41be51d8, 0x008c898f, 0x3eb96b5c, 0x688552c0, 0x5a14481b, 0x59fa5790, 0x5799deb1, 0x3fb8ee62, 0x5b2dbf47, 0x111daec1, 0xa038de38, 0x8c6c6c4b, 0x21cd6869, 0x9414cc81, 0x4a3190f1, 0xb282c9b5, 0x0d2ed294, 0xbcaaf97c };

            // 17877544987992187654343337688668811701333620838743292178749892184057627521831077798509265052290734356068857026220954221201489878345003968382314118628227899237629933242174701288035818926348722712418818365247960564393377912478871669119529304081903364981861458080903828951745089776159840805933127228012157425672130087257067184810669288365126784163257417919704206249830740947234941582839524716321752443457294258395272598798111277464357342240013343925967787858268102754925342629817105902638438892062204764865535127381588640442167863015250985100326577178909424491163326901564059492654842556293702409089616392735364597508567
            _calculator.NPrime = new uint[] { 0x90d169d7, 0x13c89bee, 0x8c2eec28, 0xd8ac3289, 0x334b7e51, 0x8fb7fe44, 0x21bae550, 0xd4042ff0, 0xba59aa27, 0xf643c578, 0x6e92b0fb, 0x2a19df93, 0xa975d66a, 0xfde5a9a6, 0x73a65179, 0xc6adab28, 0xd9796c7a, 0xa29fd54a, 0x0cba57d0, 0xbdedac74, 0x1986ad46, 0x065ce41d, 0x112a213b, 0x92e80321, 0x998b5905, 0x9437205a, 0x866a2c2e, 0xf8b5fa83, 0x2f3eac15, 0xaa2244ac, 0x84f79256, 0xd5ce28f0, 0x1278b09e, 0x45fbab9c, 0x51a2df07, 0x49a35fe5, 0x95eaed40, 0x807d7a62, 0x2055f077, 0x7963d5fc, 0xb71ca5b2, 0x9bf9d4fc, 0xeb401e58, 0xe7d31adc, 0x3493bc6c, 0x4fd2d8a6, 0x9fb45846, 0xc7283af4, 0xa5c0ec7e, 0xffc77af6, 0x41a010f8, 0x4723dcf9, 0xa9c06388, 0xcc767c13, 0x5dc5ae3b, 0x1bcd74c0, 0x0190b139, 0x64360845, 0x2f3be4c8, 0xcf1d5fc4, 0x69953306, 0x49f0f63e, 0xaba74251, 0x8d9e103d };

            // 14638102595048586577708718216730579952457826203746837920688102150000615769246025152423542091298791120123581481022682846737796339099168972888109509287741124902081188888029692466362833052588986989736754359107483850583257776711711445183410844618725679448547758156941148506617335834262201205343338864598210401779548692802928415136915178057376233239592457119278123895435321049855935114348872843680932328688874757900674021579757523921758458318834159578202963099634201413144783136173147355717946564123127599734021661066023829989645965514717497466213508901700511088833436331955355356310525179278528284418808380734020330409466
            var value = new uint[] { 0x74934dfa, 0xbbbbc41d, 0xb5cafc17, 0xfd48cac9, 0x605c59ba, 0xdccdc848, 0x69e5df7d, 0x3cbca2a0, 0xbda69b8c, 0xaec9d50c, 0x7bb0f7b4, 0x4b595a8c, 0x4f1d3f35, 0x1ef4242b, 0x4d81b1a3, 0x2cd0ec97, 0x24824d4f, 0x9f5542ac, 0x4cefe457, 0x9be35fcc, 0x8e7beb29, 0x581d100a, 0x9139f282, 0x6cd1a6d3, 0xc4f3b03f, 0x24508b15, 0x2a2cd738, 0xcd501e6c, 0x134db049, 0x3fd9cbbb, 0x185e6ef4, 0x98ef4601, 0x030ce621, 0x1870132f, 0x65a2e74b, 0x2a5fb313, 0x58e09c26, 0xcf80d3f9, 0x99a72166, 0x24bea6c8, 0x2648d9f6, 0xa17ec2ca, 0x35fab8e1, 0xcd1b4d1d, 0x68026fe1, 0x5a84f623, 0x0f64bf1b, 0xf399ee87, 0xfdc34b8c, 0x590ccac6, 0xa7e14757, 0x500d3420, 0x4faaec14, 0xeb339ca9, 0x8b2ca97e, 0x3d654f94, 0x59019193, 0x3edb8473, 0xf620992f, 0xdf131b08, 0xd9c33d90, 0x4e02c91a, 0xd3bce471, 0x73f4c387 };
            var exponent = 65537;
            _calculator.ModPow(value, exponent, _callback);
        }
    }
}
